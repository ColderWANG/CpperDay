- [1 处理机调度 概念、层次](#1-处理机调度-概念层次)
  - [1.1 调度的三个层次--高级调度（作业调度，外存->内存）](#11-调度的三个层次--高级调度作业调度外存-内存)
  - [1.2 调度的三个层次--中级调度（内存调度，外存->内存）](#12-调度的三个层次--中级调度内存调度外存-内存)
    - [1.2.1 进程的挂起态与七状态模型](#121-进程的挂起态与七状态模型)
  - [1.3 调度的三个层次--低级调度（进程调度，内存->cpu）](#13-调度的三个层次--低级调度进程调度内存-cpu)
- [2 进程调度的时机、切换与过程、方式](#2-进程调度的时机切换与过程方式)
  - [2.1 进程调度的时机](#21-进程调度的时机)
    - [2.1.1 需要进行](#211-需要进行)
    - [不2.1.2 能进行](#不212-能进行)
  - [2.2 进程调度的方式](#22-进程调度的方式)
  - [2.3 进程的切换与过程](#23-进程的切换与过程)
- [3 调度算法的评价指标](#3-调度算法的评价指标)
- [4 调度算法](#4-调度算法)
  - [4.1 先来先服务 First Come First Server (FCFS)](#41-先来先服务-first-come-first-server-fcfs)
  - [4.2 短作业优先 Shortest Job First（SJF） 或 短进程优先 SPF](#42-短作业优先-shortest-job-firstsjf-或-短进程优先-spf)
  - [4.3 高响应比优先 Highest Response Ratio Next (HRRN)](#43-高响应比优先-highest-response-ratio-next-hrrn)
  - [4.4 时间片轮转调度算法 Round-Robin（RR）](#44-时间片轮转调度算法-round-robinrr)
  - [4.5 优先级调度算法](#45-优先级调度算法)
  - [4.6 多级反馈队列调度算法](#46-多级反馈队列调度算法)

# 1 处理机调度 概念、层次
由于资源有限，确定某种规则来决定执行的顺序。从就绪队列中按照算法选择一个进程，并将处理机分配给他，以实现进程的并发执行。

## 1.1 调度的三个层次--高级调度（作业调度，外存->内存）
由于内存空间有限，无法把提交的作业（外存的数据）全部放入内存运行，因此需要确定某种规则决定作业调入内存的顺序。

高级调度（作业调度）是外存和内存的调度，建立相应的进程PCB。

## 1.2 调度的三个层次--中级调度（内存调度，外存->内存）
引入了虚拟存储技术之后，可将暂时不能运行的进程调至外存等待，等具备了运行条件再次调入内存。
**提高内存的利用率和系统吞吐量**，调到外存的进程状态为**挂起状态**，PCB不会被调到外存，而是被放入**挂起队列**  

中级调度（内存调度）就是决定哪个处于挂起状态的进程重新调入内存

### 1.2.1 进程的挂起态与七状态模型
挂起态又分为就绪挂起和阻塞挂起

## 1.3 调度的三个层次--低级调度（进程调度，内存->cpu）
按照某种方法和策略从就绪队列中选取一个进程，将处理机分配给它。

# 2 进程调度的时机、切换与过程、方式
## 2.1 进程调度的时机
### 2.1.1 需要进行
1. 进程主动放弃处理机（1.进程正常终止 2.异常终止 3.主动请求阻塞如等待I/O）
2. 被动放弃（1.时间片用完 2.更紧急的事件处理如I/O中断 3.有更高优先级的进程进入就绪队列）

### 不2.1.2 能进行
1. 处理中断的过程中
2. 操作系统内核程序临界区（临界区是访问临界资源的那段代码，而内核程序临界区一般用来访问某种**内核数据结构**的资源，比如进程的就绪队列）
3. 在原子操作过程中

## 2.2 进程调度的方式
1. 非剥夺调度方式（非抢占式） 实现简单，无法及时处理紧急任务
2. 剥夺调度方式（抢占式）可以优先处理更紧急的任务，也可以让进程按时间片轮流执行的功能

## 2.3 进程的切换与过程
进程切换的过程主要完成了：
1. 对原来运行的进程各种数据的保存
2. 对新的进程各种数据的恢复

# 3 调度算法的评价指标
1. cpu利用率
2. 系统吞吐量
3. 周转时间
4. 等待时间
5. 响应时间

# 4 调度算法
## 4.1 先来先服务 First Come First Server (FCFS)
作业调度中，先到达后备队列的先服务，在进程调度中，先到达就绪队列的先服务。是**非抢占式**的算法，不会导致饥饿。
优点：公平，算法简单。

缺点：对长作业有利，对短作业不利（短作业的带权周转时间很大，体验不好）
。
## 4.2 短作业优先 Shortest Job First（SJF） 或 短进程优先 SPF
追求最少的平均等待时间，最少的平均周转时间，最少的平均带权周转时间。 服务时间短的作业/进程优先得到服务，是**非抢占式**的算法，但是也有**抢占式**的版本--**最短剩余时间优先算法 SRTN**
优点：“最短的”平均等待时间，平均周转时间

缺点：不公平。对短作业有利，对长作业不利，**可能产生饥饿**，如果源源不断有短作业到来，可能使得长作业长时间得不到服务，产生**饥饿现象**

## 4.3 高响应比优先 Highest Response Ratio Next (HRRN) 
综合考虑作业/进程的等待时间和要求服务的时间。**非抢占式**的算法

规则：在每次调度时先计算各个作业/进程的**响应比**，选择**响应比最高**的作业/进程为其服务，响应比=（等待时间+要求服务时间）/要求服务时间

优点：综合考虑了等待时间和运行时间（要求服务时间）
综合前两个算法的优点，**避免了饥饿**问题

## 4.4 时间片轮转调度算法 Round-Robin（RR） 
公平地、轮流地为各个进程服务，按照各进程到达就绪队列的顺序，轮流让各个进程执行一个**时间片**，用于**进程调度**，属于**抢占式**的算法，不会导致饥饿，由时钟装置发出**时钟中断**来通知CPU时间片已到

优点：公平，响应快，适用于分时操作系统，使得**各个进程得到及时响应**

缺点：由于高频率的进程切换，因此有一定开销，不区分任务的紧急程度
## 4.5 优先级调度算法
根据任务的紧急程度来决定处理顺序，每个作业/进程有自己的优先级，**抢占式和非抢占式都有**，就绪队列未必只有一个，并且有**静态优先级**--创建进程后一直不变和**动态优先级**--创建进程后有一个初始值，之后会动态调整。

通常情况下 系统进程**高于**用户进程，前台进程**高于**后台进程，操作系统更**偏好I/O型进程**（又称I/O繁忙型进程，相对的是计算型进程（CPU繁忙型进程））

优点：优先级区分紧急程度、重要程度，适用于实时操作系统。**灵活调整**对进程/作业的偏好程度
缺点：可能会**导致饥饿**
## 4.6 多级反馈队列调度算法
对其他调度算法的折中权衡，用于**进程调度**，是**抢占式**的算法，也有非抢占式的，可能会**导致饥饿**。

规则：
1. 设置多级就绪队列，各级队列优先级从高到低，时间片从小到大
2. 新进程到达时进入第1级队列，按 FCFS 原则排队等待分配时间片，若用完时间片进程还未结束，则进程进入下一级队列尾。
3. 只有第 k 级队列为空时，才会为 k+1 级队头的进程分配时间片

优点：对各类型进程相对公平（FCFS），每个新到达的进程可以很快得到响应（RR），短进程用较少的时间可以完成（SPF），不必实现估计进程的运行时间（避免用户作假），可灵活调整各类进程的偏好程度（可以因I/O阻塞的进程在唤醒的时候重新放回原队列，这样就保持较高优先级）