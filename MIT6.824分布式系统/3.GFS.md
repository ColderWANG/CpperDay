## GFS google file system 设计
是一种大规模可扩展容错的分布式文件系统

### 需求
运行于普通机器上，失效是常态
大文件普遍存在，但是小文件也是存在的
大规模的顺序读写是普遍现象，但是随机读写也是存在的，
多个生产者同时对一个大文件进行顺序写操作
吞吐优先于延迟

### 接口
分层组织目录
增删，打开，关闭，读写文件
快照（瞬间创建非常大的数据）
原子追加

### 架构
master：
单节点存储元数据信息
元数据信息有
1. 名称空间
2. 文件被分解为 chuck 存储
3. chuck 存储在哪个 chuck server 上
4. chuck server 在什么位置
5. 位置信息 chuck server 最有决定权，每次都 poll 更新
行为：
1. 检查chuck server 的活跃
2. chuck 的检查、清理、复制
3. 并发访问控制

chuck server：
接受 master 的调度信息和 客户端的请求信息，快速查找并加载到磁盘中
尺寸权衡：
1. 大文件减少元数据，容易造成热点
2. 小文件增加元数据负担，但可以避免热点

客户端：
sdk 的形式内嵌
封装 master 与 chuck server 间的交互
且无需缓存数据，但缓存元数据

### 一致性模型
全部更新完毕叫做一致
所有客户端都能读到已写的数据叫做定义，读一个数据读到两个不一样的内容叫做未定义


## 系统交互
### 租约与变更
减少与 master 的交互，提升吞吐量和可用性
从 chuck 副本中选择一个主 chuck，返回给客户端主 chuck 标记以及其他副本位置，客户端缓存这些数据直到某个时间戳

## master 节点炒作
名称空间操作
副本管理
垃圾收集
失效副本的检查

## 容错和诊断
高可用性：
1. 迅速恢复
2. 冗余存储
3. 数据完整性

